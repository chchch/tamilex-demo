import{b as y,j as b,d as O,e as C,bz as E,bA as R,aL as T,g as k,P as D,w as q}from"./index-8c8278a9.js";import{Z as N,r as l,w as _,l as V,a_ as W,bQ as G,k as K,ck as z,s as B,$ as F,x as H}from"./CloseSharp-60c80ded.js";import{A as M}from"./WorkspaceArea-67fe1fcc.js";import{R as J,J as L,n as Q}from"./index-fe085b89.js";import{A as I}from"./Avatar-6097aec8.js";import"./index-0b8b5eef.js";import"./withWidth-5fc829bc.js";import"./_flatRest-72e938a0.js";import"./extends-702966c0.js";function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(t,e,n){return e&&P(t.prototype,e),n&&P(t,n),t}function Y(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}function w(t,e){return w=Object.setPrototypeOf||function(r,a){return r.__proto__=a,r},w(t,e)}function Z(t){var e=te();return function(){var r=d(t),a;if(e){var i=d(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return ee(this,a)}}function ee(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}function p(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},d(t)}var j=function(t){Y(n,t);var e=Z(n);function n(r){var a;return U(this,n),a=e.call(this,r),a.state={requestedAnnotations:!1},a.handleSelect=a.handleSelect.bind(p(a)),a.handleKey=a.handleKey.bind(p(a)),a.handleIntersection=a.handleIntersection.bind(p(a)),a}return X(n,[{key:"handleSelect",value:function(){var a=this.props,i=a.canvas,c=a.selected,u=a.setCanvas,o=a.focusOnCanvas;c?o():u(i.id)}},{key:"handleKey",value:function(a){var i=this.props,c=i.canvas,u=i.setCanvas,o=i.focusOnCanvas;this.keys={enter:"Enter",space:" "},this.chars={enter:13,space:32};var s=a.key===this.keys.enter||a.which===this.chars.enter||a.key===this.keys.space||a.which===this.chars.space;s?o():u(c.id)}},{key:"handleIntersection",value:function(a){var i=a.isIntersecting,c=this.props,u=c.annotationsCount,o=c.requestCanvasAnnotations,s=this.state.requestedAnnotations;!i||u===void 0||u>0||s||(this.setState({requestedAnnotations:!0}),o())}},{key:"render",value:function(){var a=this.props,i=a.annotationsCount,c=a.searchAnnotationsCount,u=a.canvas,o=a.classes,s=a.config,f=a.selected,v=new N(u);return l.createElement(J,{onChange:this.handleIntersection},l.createElement("div",{key:u.index,className:y(o.galleryViewItem,f?o.selected:"",c>0?o.hasAnnotations:""),onClick:this.handleSelect,onKeyUp:this.handleKey,role:"button",tabIndex:0},l.createElement(L,{resource:u,labelled:!0,variant:"outside",maxWidth:s.width,maxHeight:s.height,style:{margin:"0 auto",maxWidth:"".concat(Math.ceil(s.height*v.aspectRatio),"px")}},l.createElement("div",{className:o.chips},c>0&&l.createElement(b,{avatar:l.createElement(I,{className:o.avatar,classes:{circle:o.avatarIcon}},l.createElement(Q,{fontSize:"small"})),label:c,className:y(o.searchChip),size:"small"}),(i||0)>0&&l.createElement(b,{avatar:l.createElement(I,{className:o.avatar,classes:{circle:o.avatarIcon}},l.createElement(M,{className:o.annotationIcon})),label:i,className:y(o.annotationsChip),size:"small"})))))}}]),n}(l.Component);j.defaultProps={annotationsCount:void 0,config:{height:100,width:null},requestCanvasAnnotations:function(){},searchAnnotationsCount:0,selected:!1};function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A(Object(n),!0).forEach(function(r){ne(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ne(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var re=function(e){return{annotationIcon:{height:"1rem",width:"1rem"},annotationsChip:g({},e.typography.caption),avatar:{backgroundColor:"transparent"},chips:{opacity:.875,position:"absolute",right:0,textAlign:"right",top:0},galleryViewItem:{"&$hasAnnotations":{border:"2px solid ".concat(e.palette.action.selected)},"&$selected,&$selected$hasAnnotations":{border:"2px solid ".concat(e.palette.primary.main)},"&:focus":{outline:"none"},"&:hover":{backgroundColor:e.palette.action.hover},border:"2px solid transparent",cursor:"pointer",display:"inline-block",margin:"".concat(e.spacing(1),"px ").concat(e.spacing(.5),"px"),maxHeight:function(r){return r.config.height+45},minWidth:"60px",overflow:"hidden",padding:e.spacing(.5),position:"relative",width:"min-content"},hasAnnotations:{},searchChip:g(g({},e.typography.caption),{},{"&$selected $avatar":{backgroundColor:e.palette.highlights.primary},marginTop:2}),selected:{}}},ae=function(e,n){var r=n.canvas,a=n.windowId,i=V(e,{windowId:a}),c=E(e,{windowId:a}),u=W(c.map(function(s){return s.resources})).filter(function(s){return s.targetId===r.id}),o=G(e,{content:"annotations",windowId:a}).length>0;return{annotationsCount:function(){if(!!o){var s=R(e,{canvasId:r.id});return s.reduce(function(f,v){return f+v.resources.filter(function($){return $.targetId===r.id}).length},0)}}(),config:K(e).galleryView,searchAnnotationsCount:u.length,selected:i&&i.id===r.id}},oe=function(e,n){var r=n.canvas,a=n.id,i=n.windowId;return{focusOnCanvas:function(){return e(z(i,"single"))},requestCanvasAnnotations:function(){return e(T(i,r.id))},setCanvas:function(){for(var u=arguments.length,o=new Array(u),s=0;s<u;s++)o[s]=arguments[s];return e(B.apply(k,[i].concat(o)))}}},ie=O(C(ae,oe),_(re)),se=ie(j);function ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ue(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),t}function le(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function m(t,e){return m=Object.setPrototypeOf||function(r,a){return r.__proto__=a,r},m(t,e)}function fe(t){var e=he();return function(){var r=h(t),a;if(e){var i=h(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return pe(this,a)}}function pe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(t)}function de(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function he(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},h(t)}var S=function(t){le(n,t);var e=fe(n);function n(){return ce(this,n),e.apply(this,arguments)}return ue(n,[{key:"render",value:function(){var a=this.props,i=a.canvases,c=a.classes,u=a.viewingDirection,o=a.windowId,s=u==="right-to-left"?"rtl":"ltr";return l.createElement(D,{component:"section",dir:s,square:!0,elevation:0,className:c.galleryContainer,id:"".concat(o,"-gallery")},i.map(function(f){return l.createElement(se,{key:f.id,windowId:o,canvas:f})}))}}]),n}(l.Component);S.defaultProps={classes:{},viewingDirection:""};var ve=function(e,n){var r=n.windowId;return{canvases:F(e,{windowId:r}),viewingDirection:H(e,{windowId:r})}},ye=function(e){return{galleryContainer:{alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",overflowX:"hidden",overflowY:"scroll",padding:"50px 0 50px 20px",width:"100%"}}},we=O(_(ye),C(ve),q("GalleryView")),ge=we(S);export default ge;
